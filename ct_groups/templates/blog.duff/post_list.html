{% extends "blog/base_blog.html" %}
{% load i18n markup ct_groups_tags comments %}

{% block title %}Post archive{% endblock %}
{% block body_class %}{{ block.super }} post_list{% endblock %}


{% block content_title %}
  <h2>Post archive</h2>
{% endblock %}


{% block content %}
<div class="box-section">

    {% for post in object_list %}
      {% if post.ctpost|post_access:user %}
          {# lets permitted user through even if not public  #}
          <div class="entry">
              <h3><a href="{{ post.get_absolute_url }}">{{ post.title }}</a></h3>
              <div class="entry-descr">
                  <p class="sub">{{ post.publish|date:"j M Y, H:i" }}, {{ post.author.get_full_name }}
                      {% if post.group %}
                      - {% trans 'in' %} <a href="{% url group post.group.slug %}">{{ post.group.name }}</a>
                      {% endif %}
                  </p>
              {% get_comment_count for post.ctpost as comment_count %}
              {% if comment_count %}<p class="sub"><a href="{{ post.get_absolute_url }}#comments">{%blocktrans count comment_count as counter%}{{ counter }} comment{%plural%}{{ counter }} comments{%endblocktrans%}</a></p>{% endif %}
              </div>
              {{ post.summary|textile }}            
              <p><a href="{{ post.get_absolute_url }}" class="more">read more</a></p>
          </div>      
      {% endif %}
    {% endfor %}

  
  {% if is_paginated %}
  <p class="pagination">
    {% if has_next %}
    <a class="older" href="?page={{ next }}">Older</a>
    {% endif %}
    {% if has_next and has_previous %} | {% endif %}
    {% if has_previous %}
    <a class="newer" href="?page={{ previous }}">Newer</a>
    {% endif %}
  </p>
  {% endif %}

</div>
{% endblock %}